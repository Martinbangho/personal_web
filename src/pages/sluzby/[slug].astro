---
import Base from '../../layouts/Base.astro';
import NavCtas from '../../components/NavCtas.astro';
import type { SeoInput } from '../../utils/seo';
import '../../styles/services/details.css';
import {
  buildProfessionalServiceJsonLd,
  buildWebsiteJsonLd,
  getServiceAlternates,
  getServiceEntry,
  getServiceStaticPaths,
  getServiceUrl,
} from '../../utils/services';

export async function getStaticPaths() {
  return getServiceStaticPaths('cs');
}

const slug = Astro.params.slug!;
const entry = await getServiceEntry('cs', slug);

if (!entry) {
  throw new Error(`Service with slug "${slug}" (cs) was not found.`);
}

const { Content } = await entry.render();
const alternates = await getServiceAlternates(entry);
const canonicalUrl = getServiceUrl('cs', entry.data.entrySlug);

const seo: SeoInput = {
  title: entry.data.seo.title,
  description: entry.data.seo.description,
  canonical: canonicalUrl,
  ogTitle: entry.data.seo.ogTitle ?? entry.data.seo.title,
  ogDescription: entry.data.seo.ogDescription ?? entry.data.seo.description,
  ogUrl: canonicalUrl,
  alternates,
};

const websiteJsonLd = buildWebsiteJsonLd('cs');
const professionalServiceJsonLd = await buildProfessionalServiceJsonLd('cs');
---
<Base seo={seo} navClass="pt-25" navTopClass="pb-25">
  <NavCtas lang="cs" />
  <Fragment slot="head">
    <!-- reCAPTCHA v3 -->
    <script src="https://www.google.com/recaptcha/enterprise.js?render=6LeLuxwrAAAAACS4SwjIa4pBGqOty0K_qNOrtHtI"></script>

    <!-- Structured data -->
    <script type="application/ld+json">
      {JSON.stringify(websiteJsonLd)}
    </script>
    <script type="application/ld+json">
      {JSON.stringify(professionalServiceJsonLd)}
    </script>
  </Fragment>
  <main>
    <Content />
  </main>
</Base>
